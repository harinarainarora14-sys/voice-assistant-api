<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Voice & Text Assistant</title>
<style>
body { background:#0a0a0a; color:#fff; font-family:sans-serif; margin:0; }
#chat-container { height:70vh; overflow-y:auto; padding:10px; }
.bubble { padding:10px; margin:6px 0; border-radius:12px; max-width:80%; }
.user { background:#0077cc; margin-left:auto; text-align:right; }
.bot { background:#222; margin-right:auto; text-align:left; }
#controls { display:flex; gap:6px; padding:10px; }
#controls input { flex:1; padding:8px; border-radius:6px; border:none; background:#222; color:#fff; }
#controls button { padding:8px 12px; border:none; border-radius:6px; cursor:pointer; }
#geminiToggle { background:#ff8800; color:#fff; }
</style>
</head>
<body>

<div id="chat-container"></div>
<div id="controls">
  <input id="textInput" placeholder="Type here..." />
  <button onclick="sendTextMessage()">Send</button>
  <button id="geminiToggle" onclick="toggleGemini()">Use Gemini: Off</button>
</div>

<script>
let apiBase = "http://localhost:8000";
let useGemini=false;

function addMessage(text,sender){
  const c=document.getElementById("chat-container");
  const b=document.createElement("div");
  b.className="bubble "+sender; b.innerText=text; c.appendChild(b);
  c.scrollTop=c.scrollHeight;
}

function toggleGemini(){
  useGemini=!useGemini;
  document.getElementById("geminiToggle").innerText = "Use Gemini: " + (useGemini?"On":"Off");
}

async function sendTextMessage(){
  const input=document.getElementById("textInput"); let text=input.value.trim(); if(!text) return;
  addMessage(text,"user"); input.value="";
  try{
    const res=await fetch(`${apiBase}/ask?question=${encodeURIComponent(text)}&use_gemini=${useGemini}`);
    const data=await res.json();
    addMessage(data.answer,"bot");
    if('speechSynthesis' in window) window.speechSynthesis.speak(new SpeechSynthesisUtterance(data.answer));
  }catch(err){ addMessage("Error connecting to API","bot"); }
}
</script>

</body>
</html>
